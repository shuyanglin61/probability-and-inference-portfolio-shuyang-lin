---
title: "Monte Carlo Error"
author: "Shuyang Lin"
date: "9/8/2021"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Sorry for missing due date, this version is an uncompleted one.

```{r}
library(tidyverse)
library(ggplot2)
```


```{r}
# generate testing result
set.seed(1)
test_size <- 100000
size <- NA
for(i in 2:15) {
  size[i-1] <- 2**i
}
prob <- c(0.01,0.05,0.1,0.2,0.5)
data <- data.frame(matrix(NA,70,4))
colnames(data) <- c("size","p", "abs_error", "rel_error")
count <- 1
for(i in 1:14) {
  for(j in 1:5) {
    data[count,1] <- size[i]
    data[count,2] <- prob[j]
    temp <- rbinom(test_size,size[i],prob[j])
    data[count, 3] <- abs(mean(temp)/size[i] - prob[j])
    data[count, 4] <- data[count,3]/prob[j]
    count <- count + 1;
  }
}

data
```



```{r}
(g1 <- ggplot(data, aes(x=log(size,2),y=abs_error)) + geom_line())
```





```{r}
ggplot(Rel_Error,aes(log(size,2), X1)) + geom_line()
```



